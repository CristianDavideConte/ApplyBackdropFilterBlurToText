<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<style>
			html,body {
				margin: 0;
    		scroll-behavior: smooth;
			}

			#buttonSection {
				z-index: 2;
				position:fixed;
				display: flex;
				justify-content: center;
				align-items: center;
				width: 100vw;
				top: 50%;
			}

			button {
				cursor: pointer;
				margin: 0 5vw;
				padding: 3vmin;
				outline:none;
				border:none;
				border-radius: 1rem;
				background-color: rgba(200,30,30, 1);
				transition: all 0.3s;
			}

			button:active {
					-webkit-transform: scale3d(0.9,0.9,0.9);
					transform: scale3d(0.9,0.9,0.9);
			}

			.backgroundLayer {
					width: 100vw;
					height: 100vh;
					display: flex;
					position: fixed;
			}

			#svgWrapper {
				width: 100%;
				height: 200%;
			}

			#svg {
				width: 100%;
				height: 100%;

				/* Chrome, Safari and all webkit browsers */
  			-webkit-mask-image: url(./SVG.svg);
				-webkit-mask-size: contain;
				-webkit-mask-position: center;
				-webkit-mask-repeat: no-repeat;

				/* FIREFOX */
				mask-image: url(./SVG.svg);
				mask-size: contain;
				mask-position: center;
				mask-repeat: no-repeat;
			}

			#svg.reset {
				-webkit-mask-image: none;
				mask-image: none;
			}

			.method1 .backgroundLayer {
			  background: url(./images/backgroundOriginal.jpg) 0 0;
				background-repeat: no-repeat;
				background-position: center;
			}
/*
			#svgWrapper.method1 {
		    filter: drop-shadow(0px 0px 4px rgba(0,0,0,1));
		    -webkit-filter: drop-shadow(0px 0px 4px rgba(0,0,0,1));
		    -moz-filter: drop-shadow(0px 0px 4px rgba(0,0,0,1));
		    -ms-filter: drop-shadow(0px 0px 4px rgba(0,0,0,1));
		    -o-filter: drop-shadow(0px 0px 4px rgba(0,0,0,1));
			}
*/
			#svg.method1 {
				filter: blur(20px) saturate(180%);
				-webkit-filter: blur(20px) saturate(180%);
		    -moz-filter: blur(20px) saturate(180%);
		    -ms-filter: blur(20px) saturate(180%);
		    -o-filter: blur(20px) saturate(180%);

				background: url(./images/backgroundOriginal.jpg);
				background-repeat: no-repeat;
				background-attachment: fixed;
				background-position: center;
			}

			.method2 .backgroundLayer{
				background: url(./images/backgroundOriginal.jpg) 0 0;
				background-repeat: no-repeat;
				background-position: center;
			}

			/*#svgWrapper.method2 {
				background: url(./SVG.svg) 0 0;
				background-repeat: no-repeat;
				background-position: center;
			}*/

			#svg.method2 {
				-webkit-backdrop-filter: blur(20px) saturate(180%);
				backdrop-filter: blur(20px) saturate(180%);
			}

			.method3 .backgroundLayer {
				background: url(./images/backgroundOriginal.jpg) 0 0;
				background-repeat: no-repeat;
				background-position: center;
			}
/*
			#svgWrapper.method3 {
		    filter: drop-shadow(0px 0px 4px rgba(0,0,0,1));
		    -webkit-filter: drop-shadow(0px 0px 4px rgba(0,0,0,1));
		    -moz-filter: drop-shadow(0px 0px 4px rgba(0,0,0,1));
		    -ms-filter: drop-shadow(0px 0px 4px rgba(0,0,0,1));
		    -o-filter: drop-shadow(0px 0px 4px rgba(0,0,0,1));
			}
*/
			#svg.method3 {
				background: url(./images/backgroundBlurred.jpg);
				background-repeat: no-repeat;
				background-attachment: fixed;
				background-position: center;
			}
		</style>
	</head>

	<body>
		<section class = "backgroundLayer"></section>
		<div id = "buttonSection">
			<button id = "method1">Method 1: filter:blur()</button>
			<button id = "method2">Method 2: backdrop-filter:blur()</button>
			<button id = "method3">Method 3: mask over already-blurred background</button>
		</div>
		<section id = "svgWrapper"><div id = "svg"></div></section>
	</body>
	<script>
		function _changeMethod(className) {
			let _svgElementWrapper = document.getElementById("svgWrapper");
			let _svgElement = document.getElementById("svg");
			window.requestAnimationFrame(() => {
				_svgElementWrapper.className = className;
				_svgElement.className = className;
				document.body.className = className;
				/* The next 2 istructions allows the mask to properly adjust to the changes */
				_svgElement.classList.add("reset");
				window.requestAnimationFrame(() => _svgElement.classList.remove("reset"));

				let buttons = document.getElementsByTagName("button");
				for(const button of buttons)
					button.style.background = (button.id == className) ? "rgba(0,200,30, 1)" : "rgba(200,30,30, 1)";
			});
		}

		document.getElementById("method1").addEventListener("click", () => _changeMethod("method1"),{passive:true});
		document.getElementById("method2").addEventListener("click", () => _changeMethod("method2"),{passive:true});
		document.getElementById("method3").addEventListener("click", () => _changeMethod("method3"),{passive:true});
	</script>

	<script>
		/*
		 * Performs a scrolling test
		 */
		let _testTimes = 0;
		function testSmoothness() {
			if(_testTimes < 50) {
				let _scrollAmmount = (_testTimes % 2 == 0) ? window.scrollY + window.innerHeight : window.scrollY - window.innerHeight;
				window.scroll(0, _scrollAmmount);
				_testTimes++;
				setTimeout(testSmoothness, 800);
			}
		}
	</script>
</html>
